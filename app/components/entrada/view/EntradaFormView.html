<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!-- FormulÃ¡rio Modal -->
<div class="modal-content" ng-controller="EntradaController">
    
    <!-- CabeÃ§alho -->
    <div class="modal-header">
        <button type="button" class="close" ng-click="cancel()" aria-hidden="true">
            <span class="glyphicon glyphicon glyphicon-remove-circle" aria-hidden="true"></span>
        </button>
        <h4 class="modal-title" id="myModalLabel">
            <span class="" aria-label="Left Align">
                <span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span>
                <!--&nbsp;Novo Cliente <pre>{{customer | json}}</pre>-->
                <!--<pre>{{EstEntrada | json}}</pre>-->
                {{ title }}
            </span>
            <span>
                {{ getId() }}
            </span>

        </h4>
    </div>
    
    <!-- FormulÃ¡rio Corpo -->
    <div class="modal-body">
        
        <tabset>
            <tab heading="Informações">
                <div class="panel-body">
                    <form role="form" id="form1" name="form1" method="post" action="">
                        
                        <fieldset>
                            <legend>Dados da Entrada</legend>
                            <div class="row">
                                <div class="col-sm-12 col-lg-6">
                                    <div class="form-group">
                                        <label for="codigo">Fornecedor</label>
                                        <select 
                                            ng-model="formObject.CadFornecedor"
                                            ng-options="item.xNome for item in CadFornecedor.result track by item.xNome"
                                            class="form-control">
                                        </select>
                                        <!--<pre>{{ "2015-01-01" | date : 'short' }}</pre>-->
                                        <!--<div class="col-md-6">
                                            <p class="input-group">
                                                <input ng-model="formObject.dhabertura.date" type="date" class="form-control" datepicker-popup is-open="opened" min-date="minDate" max-date="'2015-06-22 00:00'" datepicker-options="dateOptions" date-disabled="disabled(date, mode)" ng-required="true" close-text="Close" />
                                                <span class="input-group-btn">
                                                    <button type="button" class="btn btn-default" ng-click="open($event)"><i class="glyphicon glyphicon-calendar"></i></button>
                                                </span>
                                            </p>
                                        </div>-->
                                    </div>
                                </div>
                                <div class="col-sm-6 col-lg-3">
                                    <div class="form-group">
                                        <label>Data de Abertura:</label>
                                        <pre>{{ formObject.dhabertura.date  | datetime }}</pre>
                                    </div>
                                </div>
                                <div class="col-sm-6 col-lg-3">
                                    <div class="form-group">
                                        <label>Data de Finalização:</label>
                                        <pre>{{ formObject.dhfinalizacao.date  | datetime }}</pre>
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                        
                        <fieldset ng-controller="EntradaItemController">
                            
                            <legend>Produtos</legend>
                            
                            <div class="row">
                                <!--<pre>{{EntradaItem | json}}</pre>-->
                                <div class="col-sm-12 col-lg-8">
                                    <div class="form-group">
                                        <label for="codigo">Produto</label>
                                        <!--<input type="text" ng-model="formObject.EstItem.PK_item" class="form-control" />-->
                                        <select 
                                            ng-model="formObject.EstItem" 
                                            ng-options="item.xProd for item in EstItem.result track by item.xProd"
                                            required="number"
                                            class="form-control">
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="col-sm-6 col-lg-2">
                                    <div class="form-group">
                                        <label for="codigo">Quantidade</label>
                                        <input type="text" required="string" ng-model="formObject.qtrib" class="form-control" />
                                    </div>
                                </div>
                                
                                <div class="col-sm-6 col-lg-2">
                                    <div class="form-group">
                                        <label>Valor</label>
                                        <input type="text" format="number" required="string" ng-model="formObject.vuntrib" class="form-control" />
                                    </div>
                                </div>
                                <!--<pre>{{formObject.vuntrib}}</pre>-->
                            </div>
                            
                            <div class="row">
                                <div class="col-lg-1">
                                    <button class="btn btn-info" ng-click="update()">Salvar</button>
                                </div>
                                <!--<div class="col-lg-1">
                                    <button class="btn btn-info" ng-click="logId()">Log Id</button>
                                </div>
                                <div class="col-lg-1">
                                    <button class="btn btn-info" ng-click="logDefault()">Log Default</button>
                                </div>-->
                            </div>
                            
                            <div class="row" style="margin-top: 10px">
                                <div class="col-sm-12 col-lg-12">
                                    <div class="table-responsive">
                                        <table ng-table="EntradaItemList" class="table table-striped ng-table-responsive">
                                            <tr ng-repeat="item in $data">
                                                <td data-title="'Código'">{{item.EstItem.PK_item}}</td>
                                                <td data-title="'Descrição'"><a ng-click="show(item.pkEntradaItem)">{{item.EstItem.xProd}}</a></td>
                                                <td data-title="'Qtde'">{{item.qtrib}}</td>
                                                <td data-title="'Preço'">{{item.vuntrib | cmdcur : ""}}</td>
                                                <td data-title="'Total'">{{(item.vuntrib * item.qtrib).toFixed(2) | cmdcur : ""}}</td>
                                                <td width="50">
                                                    <button ng-click="remove(item.pkEntradaItem)" type="button" class="btn btn-danger btn-circle btn-xs">
                                                        <i class="glyphicon glyphicon-trash"></i> 
                                                    </button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td></td>
                                                <td></td>
                                                <td><b>{{getTotal($data, 'qtrib')}}</b></td>
                                                <td></td>
                                                <td><b>{{getTotal($data, 'vuntrib', 'qtrib') | cmdcur : ""}}</b></td>
                                                <td></td>
                                            </tr>
                                    </table>
                                    </div>
                                </div>
                            </div>
                            
                        </fieldset>

                    </form>
                </div>
            </tab>
            <tab heading="Pagamento" active="tab.active" disabled="tab.disabled">
                
                <div class="table-responsive">
                    <!-- Table -->
                    <table ng-table="tableParams2" class="table">
                        <tr ng-repeat="contact in $data">
                            <td data-title="'Name'" style="text-align: left">{{contact.xNome}}</td>
                            <td data-title="'Phone'"><a>{{contact.phone}}</a></td>
                        </tr>
                    </table>
                </div>

            </tab>
            <tab heading="Nota Fiscal" active="tab.active" disabled="tab.disabled">

            </tab>
        </tabset>
        
    </div>
    
    <!-- Modal Footer -->
    <div class="modal-footer">
        <button ng-click="update()" type="button" class="btn btn-success pull-left">
            <span class="glyphicon glyphicon-floppy-disk"></span> Salvar
        </button>
        <button ng-click="finalizaEntrada()" type="button" class="btn btn-primary pull-left">
            <span class="glyphicon glyphicon-ok"></span> Finalizar
        </button>
        <button ng-click="cancel()" type="button" class="btn btn-default pull-left">
            <span class="glyphicon glyphicon-eye-close"></span> Fechar
        </button>
    </div>

</div>